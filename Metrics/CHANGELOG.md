# Metrics System - Changelog

## 2025-10-01 - Initial Release

### âœ¨ ÐÐ¾Ð²Ñ‹Ðµ Ð²Ð¾Ð·Ð¼Ð¾Ð¶Ð½Ð¾ÑÑ‚Ð¸

#### Ð¡ÐºÑ€Ð¸Ð¿Ñ‚Ñ‹ Ð°Ð½Ð°Ð»Ð¸Ð·Ð°
- **`analyze_langfuse_metrics.py`** - Ð°Ð½Ð°Ð»Ð¸Ð· traces Ð¸Ð· Langfuse
  - Ð˜Ð·Ð²Ð»ÐµÑ‡ÐµÐ½Ð¸Ðµ Ð´Ð¾ 100 traces Ð·Ð° Ð·Ð°Ð¿Ñ€Ð¾Ñ
  - ÐÐ½Ð°Ð»Ð¸Ð· latency, token usage, Ñ‡Ð°ÑÑ‚Ð¾Ñ‚Ñ‹ Ð¾Ð¿ÐµÑ€Ð°Ñ†Ð¸Ð¹
  - ÐÐ²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¸Ðµ Ñ€ÐµÐºÐ¾Ð¼ÐµÐ½Ð´Ð°Ñ†Ð¸Ð¸ Ð¿Ð¾ Ð¾Ð¿Ñ‚Ð¸Ð¼Ð¸Ð·Ð°Ñ†Ð¸Ð¸
  - Ð­ÐºÑÐ¿Ð¾Ñ€Ñ‚ Ð² JSON Ð¸ TXT Ñ„Ð¾Ñ€Ð¼Ð°Ñ‚Ñ‹
  - ÐŸÐ¾Ð´Ð´ÐµÑ€Ð¶ÐºÐ° Ð¼Ð½Ð¾Ð¶ÐµÑÑ‚Ð²ÐµÐ½Ð½Ñ‹Ñ… Ð¿ÑƒÑ‚ÐµÐ¹ Ðº `.env.local`

#### Ð¡ÐºÑ€Ð¸Ð¿Ñ‚Ñ‹ Ð²Ð¸Ð·ÑƒÐ°Ð»Ð¸Ð·Ð°Ñ†Ð¸Ð¸
- **`visualize_langfuse_metrics.py`** - Ð²Ð¸Ð·ÑƒÐ°Ð»Ð¸Ð·Ð°Ñ†Ð¸Ñ Ð¼ÐµÑ‚Ñ€Ð¸Ðº
  - ÐšÑ€ÑƒÐ³Ð¾Ð²Ñ‹Ðµ Ð´Ð¸Ð°Ð³Ñ€Ð°Ð¼Ð¼Ñ‹ (operation frequency)
  - Bar charts (latency, token usage)
  - Timeline Ð³Ñ€Ð°Ñ„Ð¸ÐºÐ¸ (trace Ñ€Ð°ÑÐ¿Ñ€ÐµÐ´ÐµÐ»ÐµÐ½Ð¸Ðµ)
  - Ð˜Ð½Ñ‚ÐµÑ€Ð°ÐºÑ‚Ð¸Ð²Ð½Ñ‹Ð¹ HTML dashboard (Plotly)
  - Ð¡Ñ‚Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¸Ðµ PNG Ð´Ð»Ñ Ð´Ð¾ÐºÑƒÐ¼ÐµÐ½Ñ‚Ð°Ñ†Ð¸Ð¸

#### Wrapper ÑÐºÑ€Ð¸Ð¿Ñ‚Ñ‹
- **`analyze_metrics.sh`** - ÑƒÐ´Ð¾Ð±Ð½Ñ‹Ð¹ Ð·Ð°Ð¿ÑƒÑÐº Ð°Ð½Ð°Ð»Ð¸Ð·Ð° Ð¸Ð· ÐºÐ¾Ñ€Ð½Ñ Ð¿Ñ€Ð¾ÐµÐºÑ‚Ð°
- **`visualize_metrics.sh`** - ÑƒÐ´Ð¾Ð±Ð½Ñ‹Ð¹ Ð·Ð°Ð¿ÑƒÑÐº Ð²Ð¸Ð·ÑƒÐ°Ð»Ð¸Ð·Ð°Ñ†Ð¸Ð¸ Ð¸Ð· ÐºÐ¾Ñ€Ð½Ñ Ð¿Ñ€Ð¾ÐµÐºÑ‚Ð°

#### Ð¡Ñ‚Ñ€ÑƒÐºÑ‚ÑƒÑ€Ð° ÐºÐ°Ñ‚Ð°Ð»Ð¾Ð³Ð¾Ð²
```
Metrics/
â”œâ”€â”€ scripts/        # Ð˜ÑÐ¿Ð¾Ð»Ð½ÑÐµÐ¼Ñ‹Ðµ Python ÑÐºÑ€Ð¸Ð¿Ñ‚Ñ‹
â”œâ”€â”€ data/          # JSON Ð¼ÐµÑ‚Ñ€Ð¸ÐºÐ¸ (ÑÐºÑÐ¿Ð¾Ñ€Ñ‚)
â”œâ”€â”€ reports/       # Ð¢ÐµÐºÑÑ‚Ð¾Ð²Ñ‹Ðµ Ð¾Ñ‚Ñ‡Ñ‘Ñ‚Ñ‹
â”œâ”€â”€ charts/        # Ð’Ð¸Ð·ÑƒÐ°Ð»Ð¸Ð·Ð°Ñ†Ð¸Ð¸ (PNG + HTML)
â””â”€â”€ snapshots/     # Ð˜ÑÑ‚Ð¾Ñ€Ð¸Ñ‡ÐµÑÐºÐ¸Ðµ Ð´Ð°Ð½Ð½Ñ‹Ðµ
```

#### Ð”Ð¾ÐºÑƒÐ¼ÐµÐ½Ñ‚Ð°Ñ†Ð¸Ñ
- **`README.md`** - Ð¿Ð¾Ð»Ð½Ð°Ñ Ð´Ð¾ÐºÑƒÐ¼ÐµÐ½Ñ‚Ð°Ñ†Ð¸Ñ ÑÐ¸ÑÑ‚ÐµÐ¼Ñ‹ Ð¼ÐµÑ‚Ñ€Ð¸Ðº
- **`USAGE.md`** - Ð±Ñ‹ÑÑ‚Ñ€Ñ‹Ðµ Ð¿Ñ€Ð¸Ð¼ÐµÑ€Ñ‹ Ð¸ workflow
- **`scripts/README.md`** - Ð´ÐµÑ‚Ð°Ð»Ð¸ ÑÐºÑ€Ð¸Ð¿Ñ‚Ð¾Ð²
- **`CHANGELOG.md`** - Ð¸ÑÑ‚Ð¾Ñ€Ð¸Ñ Ð¸Ð·Ð¼ÐµÐ½ÐµÐ½Ð¸Ð¹ (ÑÑ‚Ð¾Ñ‚ Ñ„Ð°Ð¹Ð»)
- ÐžÐ±Ð½Ð¾Ð²Ð»Ñ‘Ð½ ÐºÐ¾Ñ€Ð½ÐµÐ²Ð¾Ð¹ **`../README.md`** Ñ ÑÐµÐºÑ†Ð¸ÐµÐ¹ Metrics

#### Git Ð¸Ð½Ñ‚ÐµÐ³Ñ€Ð°Ñ†Ð¸Ñ
- **`.gitignore`** Ð´Ð»Ñ Ð¸ÑÐºÐ»ÑŽÑ‡ÐµÐ½Ð¸Ñ Ð³ÐµÐ½ÐµÑ€Ð¸Ñ€ÑƒÐµÐ¼Ñ‹Ñ… Ñ„Ð°Ð¹Ð»Ð¾Ð²
- `.gitkeep` Ñ„Ð°Ð¹Ð»Ñ‹ Ð´Ð»Ñ ÑÐ¾Ñ…Ñ€Ð°Ð½ÐµÐ½Ð¸Ñ ÑÑ‚Ñ€ÑƒÐºÑ‚ÑƒÑ€Ñ‹ ÐºÐ°Ñ‚Ð°Ð»Ð¾Ð³Ð¾Ð²
- Snapshot Ð¿Ð¾Ð´Ð´ÐµÑ€Ð¶ÐºÐ° Ð´Ð»Ñ Ð¸ÑÑ‚Ð¾Ñ€Ð¸Ñ‡ÐµÑÐºÐ¸Ñ… ÑÑ€Ð°Ð²Ð½ÐµÐ½Ð¸Ð¹

### ðŸ”§ Ð¢ÐµÑ…Ð½Ð¸Ñ‡ÐµÑÐºÐ¸Ðµ Ð´ÐµÑ‚Ð°Ð»Ð¸

#### Ð—Ð°Ð²Ð¸ÑÐ¸Ð¼Ð¾ÑÑ‚Ð¸
- `langfuse>=2.0,<3.0` - API ÐºÐ»Ð¸ÐµÐ½Ñ‚
- `matplotlib` - ÑÑ‚Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¸Ðµ Ð³Ñ€Ð°Ñ„Ð¸ÐºÐ¸
- `plotly` - Ð¸Ð½Ñ‚ÐµÑ€Ð°ÐºÑ‚Ð¸Ð²Ð½Ñ‹Ðµ Ð²Ð¸Ð·ÑƒÐ°Ð»Ð¸Ð·Ð°Ñ†Ð¸Ð¸
- `pandas` - Ð¾Ð±Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ° Ð´Ð°Ð½Ð½Ñ‹Ñ… (Ð¾Ð¿Ñ†Ð¸Ð¾Ð½Ð°Ð»ÑŒÐ½Ð¾)

#### Ð’Ð¾Ð·Ð¼Ð¾Ð¶Ð½Ð¾ÑÑ‚Ð¸ ÑÐºÑÐ¿Ð¾Ñ€Ñ‚Ð°
- **JSON**: ÑÑ‚Ñ€ÑƒÐºÑ‚ÑƒÑ€Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð½Ñ‹Ðµ Ð¼ÐµÑ‚Ñ€Ð¸ÐºÐ¸ Ð´Ð»Ñ Ð¿Ñ€Ð¾Ð³Ñ€Ð°Ð¼Ð¼Ð½Ð¾Ð¹ Ð¾Ð±Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ¸
- **TXT**: Ñ‡ÐµÐ»Ð¾Ð²ÐµÐºÐ¾Ñ‡Ð¸Ñ‚Ð°ÐµÐ¼Ñ‹Ðµ Ð¾Ñ‚Ñ‡Ñ‘Ñ‚Ñ‹ Ñ Ñ€ÐµÐºÐ¾Ð¼ÐµÐ½Ð´Ð°Ñ†Ð¸ÑÐ¼Ð¸
- **PNG**: ÑÑ‚Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¸Ðµ Ð³Ñ€Ð°Ñ„Ð¸ÐºÐ¸ Ð´Ð»Ñ Ð´Ð¾ÐºÑƒÐ¼ÐµÐ½Ñ‚Ð°Ñ†Ð¸Ð¸
- **HTML**: Ð¸Ð½Ñ‚ÐµÑ€Ð°ÐºÑ‚Ð¸Ð²Ð½Ñ‹Ð¹ dashboard Ð´Ð»Ñ Ð´ÐµÑ‚Ð°Ð»ÑŒÐ½Ð¾Ð³Ð¾ Ð°Ð½Ð°Ð»Ð¸Ð·Ð°

#### ÐŸÐ¾Ð´Ð´ÐµÑ€Ð¶Ð¸Ð²Ð°ÐµÐ¼Ñ‹Ðµ Ð¼ÐµÑ‚Ñ€Ð¸ÐºÐ¸
- â±ï¸ Latency (avg, p95) Ð¿Ð¾ Ð¾Ð¿ÐµÑ€Ð°Ñ†Ð¸ÑÐ¼
- ðŸ”¢ Token usage (input, output, total)
- ðŸ“Š Operation frequency (counts, percentages)
- ðŸ’° Cost estimation (Gemini pricing)
- ðŸ“… Temporal distribution (timeline)

### ðŸŽ¯ Use Cases

1. **A/B Ñ‚ÐµÑÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ Ð¿Ð°Ñ€Ð°Ð¼ÐµÑ‚Ñ€Ð¾Ð²**
   - Baseline vs Experiment ÑÑ€Ð°Ð²Ð½ÐµÐ½Ð¸Ðµ
   - Ð˜ÑÑ‚Ð¾Ñ€Ð¸Ñ‡ÐµÑÐºÐ¸Ðµ snapshots
   - Diff Ð°Ð½Ð°Ð»Ð¸Ð·

2. **ÐžÐ¿Ñ‚Ð¸Ð¼Ð¸Ð·Ð°Ñ†Ð¸Ñ Ð¿Ñ€Ð¾Ð¸Ð·Ð²Ð¾Ð´Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾ÑÑ‚Ð¸**
   - Latency bottleneck Ð²Ñ‹ÑÐ²Ð»ÐµÐ½Ð¸Ðµ
   - Token usage Ð¾Ð¿Ñ‚Ð¸Ð¼Ð¸Ð·Ð°Ñ†Ð¸Ñ
   - Cost reduction Ñ€ÐµÐºÐ¾Ð¼ÐµÐ½Ð´Ð°Ñ†Ð¸Ð¸

3. **ÐœÐ¾Ð½Ð¸Ñ‚Ð¾Ñ€Ð¸Ð½Ð³ ÐºÐ°Ñ‡ÐµÑÑ‚Ð²Ð°**
   - Operation balance (RAG vs Search)
   - Response length ÐºÐ¾Ð½Ñ‚Ñ€Ð¾Ð»ÑŒ
   - Error rate tracking (Ð±ÑƒÐ´ÑƒÑ‰Ð°Ñ Ñ„Ð¸Ñ‡Ð°)

4. **Ð”Ð¾ÐºÑƒÐ¼ÐµÐ½Ñ‚Ð°Ñ†Ð¸Ñ Ð¸ Ð¾Ñ‚Ñ‡Ñ‘Ñ‚Ð½Ð¾ÑÑ‚ÑŒ**
   - Ð¡Ñ‚Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¸Ðµ Ð³Ñ€Ð°Ñ„Ð¸ÐºÐ¸ Ð´Ð»Ñ Ð¿Ñ€ÐµÐ·ÐµÐ½Ñ‚Ð°Ñ†Ð¸Ð¹
   - Ð­ÐºÑÐ¿Ð¾Ñ€Ñ‚ Ð´Ð°Ð½Ð½Ñ‹Ñ… Ð´Ð»Ñ Ð²Ð½ÐµÑˆÐ½Ð¸Ñ… ÑÐ¸ÑÑ‚ÐµÐ¼
   - Ð˜ÑÑ‚Ð¾Ñ€Ð¸Ñ‡ÐµÑÐºÐ¸Ðµ Ñ‚Ñ€ÐµÐ½Ð´Ñ‹

### ðŸ“ ÐŸÑ€Ð¸Ð¼ÐµÑ‡Ð°Ð½Ð¸Ñ

- Langfuse API Ð¾Ð³Ñ€Ð°Ð½Ð¸Ñ‡Ð¸Ð²Ð°ÐµÑ‚ Ð´Ð¾ 100 traces Ð·Ð° Ð·Ð°Ð¿Ñ€Ð¾Ñ
- Latency Ð´Ð°Ð½Ð½Ñ‹Ðµ Ð¼Ð¾Ð³ÑƒÑ‚ Ð±Ñ‹Ñ‚ÑŒ Ð½ÐµÐ´Ð¾ÑÑ‚ÑƒÐ¿Ð½Ñ‹ Ð² Langfuse 2.x Ñ‡ÐµÑ€ÐµÐ· API
- Token usage Ð»Ð¾Ð³Ð¸Ñ€ÑƒÐµÑ‚ÑÑ Ñ‚Ð¾Ð»ÑŒÐºÐ¾ Ð´Ð»Ñ Gemini generations
- Ð”Ð»Ñ Ð±Ð¾Ð»ÑŒÑˆÐµÐ³Ð¾ ÐºÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð° traces Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐ¹Ñ‚Ðµ Langfuse UI

### ðŸ”œ ÐŸÐ»Ð°Ð½Ñ‹ Ð½Ð° Ð±ÑƒÐ´ÑƒÑ‰ÐµÐµ

- [ ] Ð¡Ñ€Ð°Ð²Ð½ÐµÐ½Ð¸Ðµ Ð½ÐµÑÐºÐ¾Ð»ÑŒÐºÐ¸Ñ… JSON Ñ„Ð°Ð¹Ð»Ð¾Ð² Ð² Ð¾Ð´Ð½Ð¾Ð¼ ÑÐºÑ€Ð¸Ð¿Ñ‚Ðµ
- [ ] ÐÐ²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¸Ð¹ trending Ð°Ð½Ð°Ð»Ð¸Ð· (week-over-week)
- [ ] Ð­ÐºÑÐ¿Ð¾Ñ€Ñ‚ Ð² PDF Ð´Ð»Ñ Ð¾Ñ‚Ñ‡Ñ‘Ñ‚Ð¾Ð²
- [ ] Ð˜Ð½Ñ‚ÐµÐ³Ñ€Ð°Ñ†Ð¸Ñ Ñ CI/CD Ð´Ð»Ñ regression Ñ‚ÐµÑÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ñ
- [ ] Email ÑƒÐ²ÐµÐ´Ð¾Ð¼Ð»ÐµÐ½Ð¸Ñ Ð¿Ñ€Ð¸ Ð´ÐµÐ³Ñ€Ð°Ð´Ð°Ñ†Ð¸Ð¸ Ð¼ÐµÑ‚Ñ€Ð¸Ðº
- [ ] Prometheus/Grafana ÑÐºÑÐ¿Ð¾Ñ€Ñ‚
- [ ] Custom scoring metrics Ð¸Ð· Langfuse

---

## ÐÐ²Ñ‚Ð¾Ñ€Ñ‹

Ð¡Ð¾Ð·Ð´Ð°Ð½Ð¾ Ð´Ð»Ñ Ð¿Ñ€Ð¾ÐµÐºÑ‚Ð° **Chrome-bot** (LangGraph + Langfuse)





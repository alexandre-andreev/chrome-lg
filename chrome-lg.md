### Оценка LangGraph и план нового проекта

- Когда LangGraph уместен
  - Нужны более сложные сценарии: несколько инструментов, разветвлённая логика, надёжные ретраи/таймауты, пошаговые проверки, журналирование и трассировка.
  - Нужны "агентные" цепочки с явной схемой состояний и правил (human-in-the-loop, memory, guardrails).

- Плюсы
  - Чёткая оркестрация (граф узлов и переходов).
  - Управление инструментами, ретраи, условные ветки.
  - Интеграция с LangSmith для наблюдаемости.
  - Проще масштабировать: добавлять новые инструменты (переводчик, парсер цен, классификатор и т.п.).

- Минусы
  - Доп. зависимость и сложность.
  - Порог входа для команды.
  - Может быть избыточным, если логика простая (как у текущего проекта).

- Рекомендация
  - Текущий проект оставить как есть.
  - Создать новый репозиторий (например, `chrome-bot-graph`) и реализовать тот же HTTP-контракт (`POST /chat`  `{answer, sources}`), но с LangGraph:
    - Узлы:
      - `ingest_context` (нормализация `page_url/title/text`)
      - `decide_search` (правило: хватит ли контекста)
      - `search_exa` (узел-инструмент)
      - `compose_answer` (сборка ответа)
      - `sanitize` (финальная чистка текста)
    - Переходы:
      - `ingest_context`  `decide_search`
      - если "да, искать"  `search_exa`  `compose_answer`
      - иначе  `compose_answer`
      - потом  `sanitize`  ответ
    - Модель: `gemini-2.5-flash` (зафиксировать).
    - Встроить backoff на rate-limit и кэш ответов на короткое время.
    - Вернуть тот же формат ответа, чтобы фронтенд расширения работал без изменений.

Итого:
- LangGraph: целесообразен для нового проекта с расширяемой, управляемой графом логикой; текущий проект не менять.
